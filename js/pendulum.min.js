function pendulum_clearScreen(a,b){b.setTransform(1,0,0,1,0,0),b.clearRect(0,0,a.width,a.height)}function pendulum_getMousePos(a,b){var c=a.getBoundingClientRect();return{x:b.clientX-c.left,y:b.clientY-c.top}}function pendulum_getRandomColor(){var a=Math.round(255*Math.random()),b=Math.round(255*Math.random()),c=Math.round(255*Math.random());return"rgb("+a+","+b+","+c+")"}function pendulum_ball(a,b,c,d){this.x=a,this.y=b,this.r=c,void 0==d?this.mass=0:this.mass=d,this.color=pendulum_getRandomColor(),this.draw=function(a){a.beginPath(),a.arc(this.x,this.y,this.r,0,2*Math.PI,!1),a.fillStyle=this.color,a.fill()},this.isPointIn=function(a,b){var c=a-this.x,d=b-this.y,e=Math.sqrt(c*c+d*d);return e<=this.r}}function pendulum_rod(a,b,c,d){this.pivotX=a,this.pivotY=b,this.moveX=c,this.moveY=d,this.length=function(){var a=this.pivotX-this.moveX,b=this.pivotY-this.moveY;return Math.sqrt(a*a+b*b)},this.theta=function(){var c,a=this.pivotX-this.moveX,b=this.pivotY-this.moveY;return c=0==b?a>0?Math.PI/2:-Math.PI/2:b>0?a<0?Math.PI/2+Math.atan(-b/a):-Math.PI/2-Math.atan(b/a):Math.atan(a/b)},this.getThetaAcceleration=function(){return-Math.sin(this.theta())/this.length()},this.addTheta=function(a){var b=this.theta()+a,c=this.length();this.moveX=c*Math.sin(b)+this.pivotX,this.moveY=c*Math.cos(b)+this.pivotY},this.move=function(a,b){var c=this.length(),d=this.moveX+a-this.pivotX,e=this.moveY+b-this.pivotY,f=Math.sqrt(d*d+e*e);d=d*c/f,e=e*c/f,this.moveX=d+this.pivotX,this.moveY=e+this.pivotY},this.draw=function(a){a.lineWidth="1",a.strokeStyle="black",a.moveTo(this.pivotX,this.pivotY),a.beginPath(),a.lineTo(this.pivotX,this.pivotY),a.lineTo(this.moveX,this.moveY),a.stroke()}}function pendulum_drawEverything(a,b){for(var c=0;c<a.length;c++)a[c].draw(b)}$(document).ready(function(){var f,a=new Array,b=null,c=$("#pendulum").get(0),d=c.getContext("2d"),e=!1,g=new pendulum_ball(c.width/2,2*c.height/3,25,50);a.push(g);var h=new pendulum_rod(c.width/2,c.height/3,c.width/2,2*c.height/3);a.push(h),pendulum_drawEverything(a,d),$("#pendulum").mousedown(function(a){var d=pendulum_getMousePos(c,a);g.isPointIn(d.x,d.y)&&(null!=b&&(window.clearInterval(b),b=null),e=!0,f=d)}),$("#pendulum").mousemove(function(b){if(e){var i=pendulum_getMousePos(c,b),j=i.x-f.x,k=i.y-f.y;f=i,h.move(j,k),g.x=h.moveX,g.y=h.moveY,pendulum_clearScreen(c,d),pendulum_drawEverything(a,d)}}),$(window).mouseup(function(){if(e){e=!1;var f=0;b=window.setInterval(function(){var b=h.getThetaAcceleration();f+=b,h.addTheta(f),g.x=h.moveX,g.y=h.moveY,pendulum_clearScreen(c,d),pendulum_drawEverything(a,d)},1e3/60)}})});

---
layout: default
title: My Vision
---

<form action="https://formspree.io/info@photovisionprints.com"
      method="POST" name="my_vision_form" class="my_vision_form">
  <h1>My Vision</h1>
  <h3>Submit or update preferences<a href="{{ site.baseurl}}/common-questions#my-vision">&nbsp;Learn more</a></h3>
  <ul>
    <li>
      <h2>Account Information</h2>
    </li>
    <li>
      <label for="email">Email<span class="required_notification">* required</span></label>
      <input id="email" type="email" name="email" placeholder="Use the email address from when you created your account"/>
    </li>
    <li>
      <h2>Preference Information</h2>
    </li>
    <li>
      <label for="image-uploader">Preference Images (click "Choose Files" or drag-and-drop files here)</label>
      <input id="image-uploader" name="image-uploader" type="file" multiple accept=".png, .jpg, .jpeg" limit="5"/>
      <div class="image-preview">
        <p>(No files currently selected for upload)</p>
      </div>
    </li>
    <li>
      <label for="instructions">Anything else we should know?<a href="{{ site.baseurl}}/common-questions#preferences">&nbsp;Learn more</a></label>
      <input type="text" name="instructions" maxlength="280"
        placeholder="(Example) &quot;Make my images the most beautiful anyone could ever possibly imagine.&quot;"/>
    </li>
	  <input type="hidden" name="_subject" value="Customer Preference Submission">
    <li>
      <button class="submit center" type="submit" disabled>Submit</button>
    </li>
  </ul>
</form>

<script type="text/javascript">
  var emailInput = document.querySelector('#email');
  var input = document.querySelector('#image-uploader');
  var preview = document.querySelector('.image-preview');
  var fileTypes = ['image/jpeg', 'image/pjpeg', 'image/png'];

  emailInput.addEventListener('change', enableSubmit);
  input.addEventListener('change', updateImageDisplay);

  function enableSubmit() {
    if(!emailInput.value){
      return;
    } else {
      document.querySelector(".submit").disabled = false;
    }
  }

  function validFileType(file) {
    for(var i = 0; i < fileTypes.length; i++) {
      if(file.type === fileTypes[i]) {
        return true;
      }
    }

    return false;
  }

  function returnFileSize(number) {
    if(number < 1024) {
      return number + 'bytes';
    } else if(number > 1024 && number < 1048576) {
      return (number/1024).toFixed(1) + 'KB';
    } else if(number > 1048576) {
      return (number/1048576).toFixed(1) + 'MB';
    }
  }

  function updateImageDisplay() {
    while(preview.firstChild) {
      preview.removeChild(preview.firstChild);
    }

    var files = input.files;
    if(!files.length) {
      var para = document.createElement('p');
      para.textContent = 'No files currently selected for upload';
      preview.appendChild(para);
    } else if(files.length > 5) {
      input.value = "";
      var para = document.createElement('p');
      para.setAttribute("class", "required_notification");
      para.textContent = 'Please limit your selection to 5 (five) images or less';
      preview.appendChild(para);
    } else {
      var list = document.createElement('ul');
      preview.appendChild(list);
      for(var i = 0; i < files.length; i++) {
        var listItem = document.createElement('li');
        var para = document.createElement('p');
        para.setAttribute("class", "required_notification");
        if(validFileType(files[i])) {
          if(files[i].size > 2621440) {
            para.textContent = files[i].name + ' is too large. Please restrict your selection to files under 2.5MB.';
            preview.appendChild(para);
          } else {
            var img = document.createElement('img');
            // img.src = createThumbnail(files[i]);
            // img.src = window.URL.createObjectURL(files[i]);
            img.src = window.URL.createObjectURL(files[i]);
            img.width = 130;
            img.onload = function() {
              window.URL.revokeObjectURL(this.src);
            }
            img.setAttribute("title", files[i].name + " -- " + returnFileSize(files[i].size));

            listItem.appendChild(img);
          }
        } else {
          para.textContent = '"' + files[i].name + '" is not a valid file type. Update your selection.';
          listItem.appendChild(para);
        }

        list.appendChild(listItem);
      }
    }
  }
</script>

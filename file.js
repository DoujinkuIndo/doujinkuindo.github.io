function list_tree(a,b){return void 0!==a._children&&a._children.forEach(function(a,c){var d="Revenue"!==get_seudoparent(a).parent.lastname?get_seudoparent(a).name:"",e=void 0===a.enlace?1:0;b.push({id:c,name:a.name,isparent:e,gruop_by:d}),list_tree(a,b)}),!1}function searc_data_in_tree(a,b,c){return a.name.toString().trim()===b?c.push(a):void 0!==a._children&&a._children.forEach(function(a){searc_data_in_tree(a,b,c)}),!1}function create_autocomplete_r(a,b){var c=[];list_tree(b,c),input_flag2=a.magicSuggest({width:"100%",emptyText:"Search",groupBy:"gruop_by",data:c,maxSelection:1,minChars:0,maxDropHeight:200,allowFreeEntries:!1,useZebraStyle:!1,renderer:function(a){var b=1===a.isparent?"isparent":"ischild";return'<div class="'+b+'">'+a.name+"</div>"},maxSelectionRenderer:function(){}}),$(input_flag2).on("selectionchange",function(a,c,d){if(d.length>0){var e=[];searc_data_in_tree(b,d[0].name.trim(),e),e.length>0&&(mouseout_rect(e[0]),mark_rect_over(e[0]),d3.select(".tooltip_revenue").style("display","none"))}else d3.selectAll(".svg_revenue .depth rect.child").attr("fill",function(a){if(d3.select(this).classed("isdeployment_last"))var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[4]:"#E9CDD7";else if(d3.select(this).classed("isdeployment"))var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[3]:all_color_bar_expenditure[2];else var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[1]:all_color_bar_expenditure[0];return b})})}function create_autocomplete(a,b){var c=[];list_tree(b,c),input_flag=a.magicSuggest({width:"100%",emptyText:"Search",groupBy:"gruop_by",data:c,maxSelection:1,minChars:0,maxDropHeight:200,allowFreeEntries:!1,useZebraStyle:!1,renderer:function(a){var b=1===a.isparent?"isparent":"ischild";return'<div class="'+b+'">'+a.name+"</div>"},maxSelectionRenderer:function(){}}),$(input_flag).on("selectionchange",function(a,c,d){if(d.length>0){var e=[];if(searc_data_in_tree(b,d[0].name.trim(),e),e.length>0)if(void 0===e[0].parent.parent)click(e[0]);else if(void 0===e[0].parent.parent.parent){click(e[0].parent);var f=setTimeout(function(){click(e[0]),clearTimeout(f)},3e3)}else if(void 0===e[0].parent.parent.parent.parent){click(e[0].parent.parent);var f=setTimeout(function(){click(e[0].parent);var a=setTimeout(function(){mark_rect_over(e[0]),d3.select(".tooltip_expenditure").style("display","none"),clearTimeout(a)},3e3);clearTimeout(f)},3e3)}}else{d3.select(".st-graphic-expenditure .g_first_child").selectAll("*").remove(),d3.select(".st-graphic-expenditure .g_second_child").selectAll("*").remove(),d3.selectAll(".st-breadcumb-expenditure").selectAll("*").remove(),create_breadcumb(obj_json[year_default],".st-breadcumb-expenditure");var g=d3.select(".option_year_expenditure").node().selectedIndex,h=array_year[g];d3.select(".control-expediture .text_graphic_complete").datum([obj_json[year_default],obj_json[h]]),compare_graphic_other_years(".content_control_expenditure",form_show),d3.selectAll(".svg_expendeture .depth rect.child").attr("fill",function(a){d3.select(this).classed("isdeployment",!1),d3.select(this).classed("isdeployment_last",!1);var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[1]:all_color_bar_expenditure[0];return b})}})}function circle_flash1(){this.transition().attr("opacity",.01).duration(3e3).attr("r",15).each("end",circle_flash2)}function circle_flash3(){d3.select(this).transition().attr("opacity",.01).duration(3e3).attr("r",15)}function circle_flash2(){d3.select(this).transition().delay(300).duration(1e-4).attr("r",7.5).attr("opacity",.8).each("end",circle_flash3)}function create_breadcumb(a,b,c){var d=d3.select(b).empty()?d3.select(b).append("div").attr("class","unit_breadcumb"):d3.select(b).insert("div",".unit_breadcumb").attr("class","unit_breadcumb");if(void 0===a.parent){var e="Expenditure"===a.lastname?"Total Expenditure":"Total Revenue";d.append("div").attr("class","breadcumb_name").html(e),d.append("div").attr("class","breadcumb_total").html("S$"+format_number(a.value/1e6)+"m"),d.append("div").attr("class","breadcumb_percentage").html("("+getPercetage(a.value,a.value)+"% of "+("Expenditure"===a.lastname?"Expenditure)":"Revenue)"))}else d.append("div").attr("class","arrow_left").append("img").attr("src","images/arrow_next.svg").attr("class","st-image-responsive"),d=d.append("div").attr("class","next_to_arrow"),d.append("div").attr("class","breadcumb_name").html(a.name.trim()),d.append("div").attr("class","breadcumb_total").html("S$"+format_number(a.value/1e6)+"m"),d.append("div").attr("class","breadcumb_percentage").style({display:c===!0?"block":"none",opacity:c===!0?1:0}).html("("+getPercetage(a.value,get_seudoparent(a).parent.value)+"% of Expenditure)"),create_breadcumb(a.parent,b,!0)}function compare_graphic_other_years(a,b){d3.selectAll(a+" .st_division_text").style("opacity",1);var c=d3.select(a+" .text_graphic_complete").datum()[0],d=d3.select(a+" .text_graphic_complete").datum()[1],e=0!==d.value?d3.round((c.value-d.value)/d.value*100,2):100*c.value;e=(e>=0?"+"+e:e)+"%";var f=(c.value-d.value)/1e6;f=(f>=0?"+S$"+format_number(f):"S$"+format_number(f))+"m";var g=".content_control_expenditure"===a?"Expenditure":"Revenue",h=".content_control_expenditure"===a?".option_year_expenditure":".option_year_revenue",i=void 0===c.parent?g:c.name;if(d3.select(a+" .text_graphic_complete").html(i+" <span class='text_bold'>"+("millon"===b?f:e)+"</span>"),void 0!==c._children&&void 0!==d._children){if(c._children.length&&d._children.length){var j=[];c._children.forEach(function(a){d._children.forEach(function(b){a.name.trim()===b.name.trim()&&j.push({name:a.name.trim(),pr:a.value,ps:b.value,diff_millon:(a.value-b.value)/1e6,diff_percentaje:0!==b.value?d3.round((a.value-b.value)/b.value*100,2):a.value})})});var k=d3.max(j,function(a){return"millon"===b?a.diff_millon:a.diff_percentaje}),l=d3.min(j,function(a){return"millon"===b?a.diff_millon:a.diff_percentaje});j.forEach(function(c){var d="millon"===b?c.diff_millon:c.diff_percentaje;if(d===k){var e=c.name,f=k;f=(f>=0?"+S$"+format_number(f):"S$"+format_number(f))+"m";var g=k;g=(g>=0?"+"+g:g)+"%",d3.select(a+" .max_increse_compareto").html("millon"===b?f:g),d3.select(a+" .term_max_increase").html("").append("span").on("click",function(){}).html(e),d3.select(a+" .text_increase_compareTo").html("Increase the most from "+array_year[d3.select(h).node().selectedIndex])}else if(d===l){var i=c.name,j=l,m="";j>=0?(j="+S$"+format_number(j)+"m",m="Increase the least from "+array_year[d3.select(h).node().selectedIndex]):(j="S$"+format_number(j)+"m",m="Decrease the most from "+array_year[d3.select(h).node().selectedIndex]);var n=l,o="";n>=0?(n="+"+n+"%",o="Increase the least from "+array_year[d3.select(h).node().selectedIndex]):(n+="%",o="Decrease the most from "+array_year[d3.select(h).node().selectedIndex]),d3.select(a+" .min_decrese_compareto").html("millon"===b?j:n),d3.select(a+" .term_min_increase").html("").append("span").html(i),d3.select(a+" .text_decrease_compareTo").html("millon"===b?m:o)}})}}else d3.selectAll(a+" .st_division_text").style("opacity",0)}function click(a){mobileCheck()?create_tooltip_expenditure(a):void 0!==a._children&&get_seudoparent(a).parent.name===year_default&&graphic_rect_child(a)}function mobileCheck(){return/Android|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent||navigator.vendor||window.opera)}function create_tooltip_expenditure(a){if(0===transitions){var b=get_seudoparent(a),c=this.getBBox(),d=this;if(b.parent.name!==year_default){var e="Expenditure"===b.parent.lastname?".svg_expendeture .expenditure"+year_default:".svg_revenue .revenue"+year_default;d3.selectAll(e+" rect.parent").each(function(b){a.name.trim()===b.name.trim()&&(a=b,d=this,c=this.getBBox())})}mark_rect_over(a);var f=d3.select("Expenditure"===b.parent.lastname?".tooltip_expenditure":".tooltip_revenue"),g=f.datum(a).style("display","block");g.selectAll("*").remove();var h="Expenditure"===b.parent.lastname?svg:svg_r,i=h.attr("height")-c.y-margin.bottom,j="S$"+format_number(a.value/1e6)+"m",k=getPercetage(a.value,get_seudoparent(a).parent.value)+"% of "+b.parent.lastname,l=d3.transform(d3.select(d.parentNode.parentNode.parentNode).attr("transform")).translate[0],m=30,n="Expenditure"===b.parent.lastname?tranlate_svg_expendeture:tranlate_svg_revenue,l=void 0===a.parent.parent?l+n:l,o=d3.transform(d3.select(".st-graphic-expenditure_translate").style("transform")).translate[0]||d3.transform(d3.select(".st-graphic-expenditure_translate").style("-webkit-transform")).translate[0]||d3.transform(d3.select(".st-graphic-expenditure_translate").style("-moz-transform")).translate[0]||d3.transform(d3.select(".st-graphic-expenditure_translate").style("-ms-transform")).translate[0];if("Expenditure"===b.parent.lastname)var p=document.getElementsByTagName("body")[0].clientWidth>768?m+l+2:m+l+2+o;else var p=m+l+2;g.style("left",p+"px"),g.append("div").attr("class","head_box_compare").html(a.name);var q="Expenditure"===b.parent.lastname?form_show:form_show_r;g.append("div").attr("class","head_box_compare").html("millon"===q?j:k),g.append("div").attr("class","percentaje_box_compare").html("("+("millon"===q?k:j)+")"),(void 0===a.parent.parent||void 0!==a.parent.parent&&void 0===a.parent.parent.parent)&&g.append("div").attr("class","svg_box_compare").append("svg").attr("width",document.getElementsByTagName("body")[0].clientWidth?180:93).attr("height",180).append("g").datum(a).call(compare_obj_other_years),void 0!==a._children&&g.append("div").attr("class","content_btn_break_down").append("button").datum(a).html("SEE BREAKDOWN").on("click",graphic_rect_child);var r=f.node().clientHeight;if(r>i)g.style({bottom:"15px",top:"auto"});else{var s="Expenditure"===b.parent.lastname?d3.select(".st-breadcumb-expenditure").node().clientHeight+15:d3.select(".st-breadcumb-revenue").node().clientHeight;g.style({bottom:"auto",top:c.y+1+s+"px"})}g.on("mouseover",mark_rect_over).on("mouseout",mouseout_rect)}}function mouseout_rect(a){var b="Expenditure"===get_seudoparent(a).parent.lastname?"expenditure":"revenue",c="Expenditure"===get_seudoparent(a).parent.lastname?"expendeture":"revenue";d3.select(".tooltip_"+b).style("display","none"),0===transitions&&(void 0==a.parent.parent?d3.selectAll(".svg_"+c+" .depth rect.child").attr("fill",function(a){if(d3.select(this).classed("isdeployment_last"))var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[4]:"#E9CDD7";else if(d3.select(this).classed("isdeployment"))var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[3]:all_color_bar_expenditure[2];else var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[1]:all_color_bar_expenditure[0];return b}):void 0===a.parent.parent.parent?(d3.selectAll(".g_first_child .depth rect.child").attr("fill",function(){if(d3.select(this).classed("isdeployment"))var a=all_color_bar_expenditure[4];else var a=all_color_bar_expenditure[3];return a}),d3.selectAll(".svg_expendeture .depth rect.isdeployment").attr("fill",function(a){if(d3.select(this).classed("isdeployment_last"))var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[4]:"#E9CDD7";else var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[3]:all_color_bar_expenditure[2];return b})):void 0===a.parent.parent.parent.parent&&(d3.selectAll(".g_second_child .depth rect.child").attr("fill",function(){var a=all_color_bar_expenditure[4];return a}),d3.selectAll(".g_first_child .depth rect.isdeployment").attr("fill",function(){return all_color_bar_expenditure[4]})))}function mark_rect_over(a){{var b="Expenditure"===get_seudoparent(a).parent.lastname?"expenditure":"revenue",c="Expenditure"===get_seudoparent(a).parent.lastname?"expendeture":"revenue";d3.select(".tooltip_"+b).style("display","block")}void 0==a.parent.parent?d3.selectAll(".svg_"+c+" .depth g").each(function(c){a.name.trim()===c.name.trim()&&d3.select(this).selectAll("rect.child").attr("fill",function(a){var d=get_seudoparent(c).parent.name===year_default?"pattern_default":"pattern_before";return d3.select(this).classed("isdeployment_last")&&(d=get_seudoparent(a).parent.name===year_default?"pattern_first_child":"g_second_child"),d3.select("#"+d+" rect").attr("fill",d3.select(this).attr("fill")),"url(#"+("expenditure"===b?d:d+"_r")+")"})}):void 0===a.parent.parent.parent?(d3.selectAll(".g_first_child .depth rect.child").each(function(){if(d3.select(this.parentNode).datum().name.trim()===a.name.trim()){var b="pattern_first_child";d3.select("#"+b+" rect").attr("fill",d3.select(this).attr("fill")),d3.select(this).attr("fill","url(#"+b+")")}}),d3.selectAll(".svg_expendeture .depth rect.isdeployment").each(function(b){if(b.name.trim()===a.name.trim()){var c=get_seudoparent(b).parent.name===year_default?"pattern_default":"pattern_before";d3.select("#"+c+" rect").attr("fill",d3.select(this).attr("fill")),d3.select(this).attr("fill","url(#"+c+")")}})):void 0===a.parent.parent.parent.parent&&(d3.selectAll(".g_second_child .depth rect.child").attr("fill",function(b){var c=void 0===d3.select(this.parentNode).select("rect.parent").datum()._children?b.name.trim():b.parent.name.trim();d3.select("#g_second_child rect").attr("fill",all_color_bar_expenditure[4]);var d=c===a.name.trim()?"url(#g_second_child)":all_color_bar_expenditure[4];return d}),d3.selectAll(".g_first_child .depth rect.isdeployment").attr("fill",function(b){var c=b.name.trim()===a.name.trim()?"url(#g_second_child)":all_color_bar_expenditure[4];return c}))}function graphic_rect_child(a){if(d3.select(".st-breadcumb-expenditure").html(""),create_breadcumb(a,".st-breadcumb-expenditure"),d3.select(".tooltip_expenditure").style("display","none"),tranlate_svg_expendeture=768>width_window?tranlate_svg_expendeture:position_axis,void 0===a.parent.parent){transitions=1,g_first_child.select(".depth").remove(),g_first_child.selectAll(".btn_go_back").remove(),g_second_child.select(".depth").remove(),g_second_child.selectAll(".btn_go_back2").remove(),g_first_child.select(".small_scale").remove(),g_second_child.select(".small_scale").remove(),g_first_child.attr("transform","translate("+(120+tranlate_svg_expendeture)+",0)");var b="millon"===form_show?max_value_every_year:a.parent.value;f_ry.domain([0,b]),initialize(a.parent),f_ry.domain([0,height_g]),layout(a.parent);var c={},d={};width_window>768&&d3.select(".st-breadcumb-expenditure").transition().duration(500).style("margin-left","0px").each("end",function(){d3.selectAll(".st-breadcumb-expenditure .breadcumb_percentage").transition().duration(500).style({display:"block",opacity:1})}),svg_expendeture.transition().duration(1e3).attr("transform","translate("+tranlate_svg_expendeture+",0)").each("end",function(){display(a,g_first_child);var b=width_complete-width_window>=120?120:width_complete-width_window,c=width_window>=524?width_window/2-width_u/2:width_window/2-width_u/2+b;if(768>=width_window){d3.select(".st-graphic-expenditure_translate").classed("move_126",!0);var d=g_first_child.transition().duration(1e3).attr("transform","translate("+(tranlate_svg_expendeture+width_g+126)+",0)")}else var d=g_first_child.transition().duration(1e3).attr("transform","translate("+c+",0)");d.each("end",function(){var b=this;f_ry.domain([0,a.value]),initialize(a),f_ry.domain([0,height_g]),layout(a),d3.select(b).selectAll(".depth").style("shape-rendering",null),d3.select(this).datum(a),d3.select(this).selectAll(".depth rect").transition().duration(750).call(rect2).each("end",function(){d3.select(b).selectAll(".depth").style("shape-rendering","crispEdges"),transitions=0})});var e=g_first_child.append("g").attr("class","btn_go_back");e.append("rect").attr("width",27).attr("height",27).attr("fill","#E7EAED"),e.append("polyline").attr("points","13,19 8.8,14.8 13,10.5").attr("stroke","#666").attr("stroke-width",1.5).attr("stroke-miterlimit",10).attr("fill","none"),e.append("polyline").attr("points","8.8,14.8 19.9,14.8 19.9,7.4 17.3,7.4").attr("stroke","#666").attr("stroke-width",1.5).attr("stroke-miterlimit",10).attr("fill","none"),e.attr("transform","translate(99,0)").attr("cursor","pointer").on("click",function(){d3.select(".st-graphic-expenditure_translate").classed("move_126",!1),d3.select(".st-graphic-expenditure_translate").classed("move_252",!1),g_first_child.select(".depth").remove(),g_first_child.selectAll(".btn_go_back").remove(),g_second_child.select(".depth").remove(),g_second_child.selectAll(".btn_go_back2").remove(),g_first_child.select(".small_scale").remove(),g_second_child.select(".small_scale").remove(),d3.select(d3.selectAll(".unit_breadcumb")[0][1]).remove(),d3.select(d3.selectAll(".unit_breadcumb")[0][2]).remove(),d3.selectAll(".svg_expendeture .depth rect.child").attr("fill",function(a){d3.select(this).classed("isdeployment",!1),d3.select(this).classed("isdeployment_last",!1);var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[1]:all_color_bar_expenditure[0];return b})}),document.getElementById("rad-total-expenditure").checked||g_first_child.select(".small_scale").attr("opacity",0)}).selectAll("g.depth .children").each(function(b){if(b.name.trim()===a.name.trim()&&(get_seudoparent(b).parent.name===array_year[d3.select(".option_year_expenditure").node().selectedIndex]&&(c=b),get_seudoparent(b).parent.name===year_default&&(d=b)),d3.select(this).selectAll(".child").classed("isdeployment_last",!1),get_seudoparent(b).parent.name===year_default){var e=b.name.trim()===a.name.trim()?all_color_bar_expenditure[3]:all_color_bar_expenditure[1];d3.select(this).selectAll(".child").attr("fill",e).classed("isdeployment",b.name.trim()===a.name.trim())}else{var e=b.name.trim()===a.name.trim()?all_color_bar_expenditure[2]:all_color_bar_expenditure[0];d3.select(this).selectAll(".child").attr("fill",e).classed("isdeployment",b.name.trim()===a.name.trim())}}),d3.select(".text_graphic_complete").datum([d,c]),compare_graphic_other_years(".content_control_expenditure",form_show)}else if(void 0===a.parent.parent.parent){g_first_child.select(".btn_go_back").style("display","none"),g_second_child.select(".depth").remove(),g_second_child.select(".small_scale").remove(),g_second_child.attr("transform","translate(120,0)"),transitions=1;var b="millon"===form_show?max_value_every_year:a.parent.value;f_ry.domain([0,a.parent.value]),initialize(a.parent),f_ry.domain([0,height_g]),layout(a.parent);var c={},d={},e=0,f=0;f=width_complete-width_u-210,e=f/2+width_g/2-10,g_first_child.transition().duration(1e3).attr("transform","translate("+(tranlate_svg_expendeture+width_g+126)+",0)").each("end",function(){d3.transform(g_first_child.attr("transform")).translate;g_second_child.attr("transform","translate("+(tranlate_svg_expendeture+width_g+126)+",0)"),768>=width_window&&d3.select(".st-graphic-expenditure_translate").classed("move_252",!0),display(a,g_second_child),g_second_child.transition().duration(1e3).attr("transform","translate("+(tranlate_svg_expendeture+width_g+126+156)+",0)").each("end",function(){var b=this;f_ry.domain([0,a.value]),initialize(a),f_ry.domain([0,height_g]),layout(a),d3.select(b).selectAll(".depth").style("shape-rendering",null),d3.select(this).datum(a),d3.select(this).selectAll(".depth rect").transition().duration(750).call(rect3).each("end",function(){d3.select(b).selectAll(".depth").style("shape-rendering","crispEdges"),transitions=0})});var b=g_second_child.append("g").attr("class","btn_go_back2");b.append("rect").attr("width",27).attr("height",27).attr("fill","#E7EAED"),b.append("polyline").attr("points","13,19 8.8,14.8 13,10.5").attr("stroke","#666").attr("stroke-width",1.5).attr("stroke-miterlimit",10).attr("fill","none"),b.append("polyline").attr("points","8.8,14.8 19.9,14.8 19.9,7.4 17.3,7.4").attr("stroke","#666").attr("stroke-width",1.5).attr("stroke-miterlimit",10).attr("fill","none"),b.attr("transform","translate(99,0)").attr("cursor","pointer").on("click",function(){d3.select(".st-graphic-expenditure_translate").classed("move_252",!1),g_first_child.select(".btn_go_back").style("display","block"),g_second_child.select(".depth").remove(),g_second_child.selectAll(".btn_go_back2").remove(),g_second_child.select(".small_scale").remove(),d3.select(d3.selectAll(".unit_breadcumb")[0][2]).remove(),d3.selectAll(".svg_expendeture .depth rect.child").attr("fill",function(a){if(d3.select(this).classed("isdeployment_last",!1),d3.select(this).classed("isdeployment_last"))var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[4]:"#E9CDD7";else if(d3.select(this).classed("isdeployment"))var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[3]:all_color_bar_expenditure[2];else var b=get_seudoparent(a).parent.name===year_default?all_color_bar_expenditure[1]:all_color_bar_expenditure[0];return b}),d3.selectAll(".st-graphic-expenditure .g_first_child rect.child").attr("fill",function(){d3.select(this).classed("isdeployment",!1);var a=all_color_bar_expenditure[3];return a})}),d3.selectAll(".st-breadcumb-expenditure .breadcumb_percentage").transition().duration(500).style({display:"block",opacity:1}),document.getElementById("rad-total-expenditure").checked||g_second_child.select(".small_scale").attr("opacity",0)}).selectAll("g.depth .children").each(function(b){var c=b.name.trim()===a.name.trim()?all_color_bar_expenditure[4]:all_color_bar_expenditure[3];d3.select(this).selectAll(".child").attr("fill",c).classed("isdeployment",b.name.trim()===a.name.trim())}),d=a,d3.selectAll(".svg_expendeture .depth rect.isdeployment").each(function(b){get_seudoparent(b).parent.name===year_default?b.name.trim()===a.name.trim()?d3.select(this).classed("isdeployment_last",!0).attr("fill",all_color_bar_expenditure[4]):d3.select(this).classed("isdeployment_last",!1).attr("fill",all_color_bar_expenditure[3]):b.name.trim()===a.name.trim()?d3.select(this).classed("isdeployment_last",!0).attr("fill","#E9CDD7"):d3.select(this).classed("isdeployment_last",!1).attr("fill",all_color_bar_expenditure[2])}),d3.selectAll(".expenditure"+array_year[d3.select(".option_year_expenditure").node().selectedIndex]+" .depth rect.child").each(function(b){b.name.trim()===a.name.trim()&&(c=b)}),d3.select(".text_graphic_complete").datum([d,c]),compare_graphic_other_years(".content_control_expenditure",form_show)}}function animateScroll(a,b,c){var d=document.getElementsByClassName(a)[0],e=d.scrollLeft,f=b;if(e!==f)var g=c/Math.abs(f-e),h=e,i=setInterval(function(){f>=e?h++:h--,d.scrollLeft=h,(h===f||h===e)&&clearInterval(i)},g)}function compare_obj_other_years(){var a=this,b=a.datum(),c=[],d=document.getElementsByTagName("body")[0].clientWidth>768?180:93,e=document.getElementsByTagName("body")[0].clientWidth>768?100:93,f=d3.scale.linear().range([0,d-e]),g=get_seudoparent(b).parent.lastname,h=d3.selectAll("Expenditure"===g?".svg_expendeture g.depth rect":".svg_revenue g.depth rect.parent"),i="Expenditure"===g?form_show:form_show_r;h.each(function(a){a.name.trim()===b.name.trim()&&c.push(a)});var j=d3.max(c,function(a){return"millon"===i?b.value:format_number(a.value/get_seudoparent(a).parent.value*100)});f.domain([0,j]);var k=c.sort(function(a,b){return d3.descending(get_seudoparent(a).parent.name,get_seudoparent(b).parent.name)}),l=a.selectAll("g").data(k).enter().append("g").attr("transform",function(a,b){return"translate ( 0,"+45*b+")"});l.append("text").attr("dominant-baseline","middle").attr("y",function(){return 10}).text(function(a){return get_seudoparent(a).parent.name}).attr("fill","#666"),l.append("rect").attr("fill","#fff").attr("height",16).attr("width",function(a){return f("millon"===i?a.value:format_number(a.value/get_seudoparent(a).parent.value*100))}).attr("y",20),l.append("text").attr("dominant-baseline","middle").attr("y",function(){return 30}).text(function(a){return"millon"===i?"S$"+format_number(a.value/1e6)+"m":format_number(a.value/get_seudoparent(a).parent.value*100)+"%"}).attr("x",function(a){var b=f("millon"===i?a.value:format_number(a.value/get_seudoparent(a).parent.value*100));return b+(document.getElementsByTagName("body")[0].clientWidth>768?10:0)}).attr("fill","#333")}function draw_radio_button(a,b){var c=a.append("path").attr("d",pathDefs.fill[0]),d=c.node().getTotalLength();c.attr("stroke-dasharray",d+" "+d).attr("stroke-dashoffset",d).transition().duration(500).ease(b.fill.easing,b.fill.speed).attr("stroke-dashoffset",0)}function display_block_budget(a,b,c){var d=c.length,e=10,f=width_g-(d-1)*e,g=[],h="svg_expendeture"===b.attr("class")?"expenditure":"revenue";c.forEach(function(c,i){var j=i*(f/d)+i*e,k=b.append("g").attr("transform","translate("+j+","+margin.top+")").attr("class",h+c.year);k.append("g").attr("class","grandparent"),g.push(a[c.year].value),display(a[c.year],k)});var i=b.append("g").attr("class",h+"_axis").attr("transform","translate(-5,1)");"expenditure"===h?max_value_every_year=d3.max(g):max_value_every_year_r=d3.max(g);var j=d3.scale.linear().domain([0,"expenditure"===h?max_value_every_year:max_value_every_year_r]).range([height_g,0]),k=d3.svg.axis().scale(j).orient("left").tickFormat(function(a){return a/1e9+"b"});i.call(k)}function display(a,b){var c="#fff";if(b.attr("class")==="expenditure"+year_default){c=all_color_bar_expenditure[1],b.append("text").attr("y",height_g+margin.bottom).attr("x",15).attr("class","text_ligther").attr("text-anchor","middle").text(a.name);var d=d3.scale.linear().domain([0,a.value/1e9]).range([0,height_g]),e=b.append("g").attr("class","small_scale").attr("transform","translate(-3,0)");e.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",d(1)),e.append("text").attr("x",-20).attr("y",10).text("1b")}else if(b.attr("class")==="revenue"+year_default)c=all_color_bar_expenditure[0],b.append("text").attr("y",height_g+margin.bottom).attr("x",15).attr("class","text_ligther").attr("text-anchor","middle").text(a.name);else if("g_first_child"===b.attr("class")){c=all_color_bar_expenditure[3];var f=a.value/1e9,d=d3.scale.linear().domain([0,f]).range([0,height_g]),e=b.append("g").attr("class","small_scale").attr("transform","translate(-5,0)"),g=1>=f?d3.round(f/2,1):1;e.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",d(g)),e.append("text").attr("x",1>f?-30:-20).attr("y",10).text(g+"b")}else if("g_second_child"===b.attr("class")){c=all_color_bar_expenditure[4];var f=a.value/1e9,d=d3.scale.linear().domain([0,f]).range([0,height_g]),e=b.append("g").attr("class","small_scale").attr("transform","translate(-5,0)"),g=1>=f?d3.round(f/2,1):1;e.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",d(g)),e.append("text").attr("x",1>f?-30:-20).attr("y",10).text(g+"b")}else c=all_color_bar_expenditure[0],b.append("text").attr("y",height_g+margin.bottom).attr("x",15).attr("class","text_ligther").attr("text-anchor","middle").text(a.name);var h="",i=b.insert("g",".grandparent").datum(a).attr("class","depth"),h=i.selectAll("g").data(a._children).enter().append("g");return h.sort(function(a,b){return d3.descending(a.value,b.value)}).classed("children",function(a){return void 0!==a._children}),h.selectAll(".child").data(function(a){return a._children||[a]}).enter().append("rect").attr("class","child").call(rect).attr("fill",c),h.append("rect").attr("class","parent").on("mouseover",create_tooltip_expenditure).on("mouseout",mouseout_rect).on("click",click).call(rect).append("title").text(function(a){return"S$"+format_number(a.value/1e6)+"m"}),h}function rect(a){a.attr("x",function(a){return f_rx(a.x)}).attr("y",function(a){var b=f_ry(a.y);return b}).attr("width",function(a){return f_rx(a.x+a.dx)-f_rx(a.x)}).attr("height",function(a){var b=f_ry(a.y+a.dy)-f_ry(a.y);return b})}function rect2(a){a.attr("x",function(a){return f_rx(a.x)}).attr("y",function(a){var b=f_ry(a.y);return b}).attr("width",function(a){return f_rx(a.x+a.dx)-f_rx(a.x)}).attr("height",function(a){var b=f_ry(a.y+a.dy)-f_ry(a.y);return b})}function rect3(a){a.attr("x",function(a){return f_rx(a.x)}).attr("y",function(a){var b=f_ry(a.y);return b}).attr("width",function(a){return f_rx(a.x+a.dx)-f_rx(a.x)}).attr("height",function(a){var b=f_ry(a.y+a.dy)-f_ry(a.y);return b})}function build_enlace(a,b){var c=null,d={},e=d3.keys(a[0]);return a.forEach(function(a){var f=a[e[0]].trim();c!==f&&(c=f,d[f]=[]);var g=parseInt(a[e[2]].trim().replace(/,/g,""));d[f].push({enlace:f,year:b,name:a[e[1]].trim(),value:isNaN(g)||0===g?0:g})}),d}function build_array_key_select(a,b){var c=[];return d3.keys(a[0]).forEach(function(a){var d={};b.forEach(function(b){-1!==a.search(b)&&(d.year=b,d.key_g=a,c.push(d))})}),c}function build_json(a,b,c,d,e,f){var g=a[0],h=a[1],i=[],j={};f[b.year]=[];var k=[];return c.forEach(function(a){var c=parseInt(a[b.key_g].trim().replace(/,/g,""));c=isNaN(c)||0===c?0:c;var f=a[g].trim(),i=a[h].trim();$.inArray(f,k)>=0?j[f].children.push(b.year===d&&void 0!==e[i]?{name:i,value:c,children:e[i]}:{name:i,value:c}):(k.push(f),j[f]={},j[f].name=f,j[f].children=[],j[f].children.push(b.year===d&&void 0!==e[i]?{name:i,value:c,children:e[i]}:{name:i,value:c}))}),k.forEach(function(a){i.push(j[a])}),i}function build_json_revenue(a,b){var c={};return b.forEach(function(b){var d=b.year,e=[],f={},g={};a.forEach(function(a){var c=parseInt(a[b.key_g].trim().replace(/,/g,""));if("Special Transfers"===a.Revenue||"Net Investment Income/Returns Contribution"===a.Revenue)"Special Transfers"===a.Revenue&&(f.name=a.Revenue,f.value=isNaN(c)||0===c?0:c,f.year=b.year,f.head=b.key_g),"Net Investment Income/Returns Contribution"===a.Revenue&&(g.name=a.Revenue,g.value=isNaN(c)||0===c?0:c,g.year=b.year,g.head=b.key_g);else{var d={};d.name=a.Revenue,d.value=isNaN(c)||0===c?0:c,d.year=b.year,d.head=b.key_g,e.push(d)}}),c[d]={},c[d].special_transfer=f,c[d].net_investment_income=g,c[d].children=e,c[d].name=d,c[d].lastname="Revenue",c[d].sum=d3.sum(e,function(a){return a.value})}),c}function initialize_all_year(a,b,c){var d=[],e=[],f=[];return a.forEach(function(a){accumulate(b[a.year]),accumulate(c[a.year]),e.push(b[a.year].value),f.push(c[a.year].value)}),a.forEach(function(a){var g=b[a.year],h=c[a.year];f_ry.domain([0,d3.max(e)]),initialize(g),f_ry.domain([0,height_g]),layout(g),f_ry.domain([0,d3.max(f)]),initialize(h),f_ry.domain([0,height_g]),layout(h);var i=h.sum-g.value,j=h.special_transfer.value,k=h.net_investment_income.value;d.push([a.year,i-j+k])}),d}function initialize(a){var b=f_ry(a.value),c=height_g-b;a.x=a.y=c,a.dx=(width_g-10*(array_year.length-1))/array_year.length,a.dy=b,a.depth=0}function accumulate(a){return(a._children=a.children)?a.value=a.children.reduce(function(a,b){return a+accumulate(b)},0):a.value}function layout(a){a._children&&(treemap.size([a.dx,a.dy]).nodes({_children:a._children}),a._children.forEach(function(b){b.y=a.y+b.y,b.parent=a,layout(b)}))}function format_number(a){Math.floor(a);var b=0,c=d3.format(",d"),d=d3.format(",.2f"),e=a%1;return b=0===e?c(a):d(e)%1===0?c(Math.floor(a)+1):d(a)}function getPercetage(a,b){var c=a/b*100;return format_number(c)}function get_seudoparent(a){return void 0!==a.enlace?a.parent.parent:void 0===a.parent.parent?a:a.parent}var d_small=400,d_medium=768,d_normal=992,d_large=1280,input_flag=null,input_flag2=null,pathDefs={fill:["M15.833,24.334c2.179-0.443,4.766-3.995,6.545-5.359 c1.76-1.35,4.144-3.732,6.256-4.339c-3.983,3.844-6.504,9.556-10.047,13.827c-2.325,2.802-5.387,6.153-6.068,9.866 c2.081-0.474,4.484-2.502,6.425-3.488c5.708-2.897,11.316-6.804,16.608-10.418c4.812-3.287,11.13-7.53,13.935-12.905 c-0.759,3.059-3.364,6.421-4.943,9.203c-2.728,4.806-6.064,8.417-9.781,12.446c-6.895,7.477-15.107,14.109-20.779,22.608 c3.515-0.784,7.103-2.996,10.263-4.628c6.455-3.335,12.235-8.381,17.684-13.15c5.495-4.81,10.848-9.68,15.866-14.988 c1.905-2.016,4.178-4.42,5.556-6.838c0.051,1.256-0.604,2.542-1.03,3.672c-1.424,3.767-3.011,7.432-4.723,11.076 c-2.772,5.904-6.312,11.342-9.921,16.763c-3.167,4.757-7.082,8.94-10.854,13.205c-2.456,2.777-4.876,5.977-7.627,8.448 c9.341-7.52,18.965-14.629,27.924-22.656c4.995-4.474,9.557-9.075,13.586-14.446c1.443-1.924,2.427-4.939,3.74-6.56 c-0.446,3.322-2.183,6.878-3.312,10.032c-2.261,6.309-5.352,12.53-8.418,18.482c-3.46,6.719-8.134,12.698-11.954,19.203 c-0.725,1.234-1.833,2.451-2.265,3.77c2.347-0.48,4.812-3.199,7.028-4.286c4.144-2.033,7.787-4.938,11.184-8.072 c3.142-2.9,5.344-6.758,7.925-10.141c1.483-1.944,3.306-4.056,4.341-6.283c0.041,1.102-0.507,2.345-0.876,3.388 c-1.456,4.114-3.369,8.184-5.059,12.212c-1.503,3.583-3.421,7.001-5.277,10.411c-0.967,1.775-2.471,3.528-3.287,5.298 c2.49-1.163,5.229-3.906,7.212-5.828c2.094-2.028,5.027-4.716,6.33-7.335c-0.256,1.47-2.07,3.577-3.02,4.809"]},animDefs={fill:{speed:.8,easing:"ease-in-out"}},url_expenditure_csv="csv/expenditure.csv",url_sub_expenditure_csv="csv/sub_expenditure.csv",url_revenue_csv="csv/revenue.csv",array_year=[2012,2013,2014,2015],year_default=2015,array_branches=["Expenditure","Sector"],form_show="millon",form_show_r="millon",transitions=0,treemap=d3.layout.treemap().children(function(a,b){return b?null:a._children
}).sort(function(a,b){return d3.ascending(b.value,a.value)}).mode("dice").round(!1),div_expenditure=d3.selectAll(".st-graphic-expenditure"),div_revenue=d3.selectAll(".st-graphic-revenue");width_complete=div_expenditure.node().clientWidth;var width_window=document.getElementsByTagName("body")[0].clientWidth;width_window=width_window>=992?width_window:width_window-20,width_window=width_window>=width_complete?width_complete:width_window;var margin={top:1,right:1,bottom:15,left:1},width_g=150,width_u=30,height_g=440-margin.top-margin.bottom,f_rx=d3.scale.linear().domain([0,width_g]).range([0,width_g]),f_ry=d3.scale.linear().domain([0,height_g]).range([0,height_g]),max_value_every_year=0,max_value_every_year_r=0,position_axis=40,tranlate_svg_expendeture=width_window/2-width_g;tranlate_svg_expendeture=position_axis>=tranlate_svg_expendeture?position_axis:tranlate_svg_expendeture;var tranlate_svg_revenue=width_window/2-width_g;tranlate_svg_revenue=position_axis>=tranlate_svg_revenue?position_axis:tranlate_svg_revenue;var svg=div_expenditure.append("svg").attr("width","100%").attr("height",height_g+margin.top+margin.bottom).style("margin-left",margin.left+"px").style("margin-right",margin.right+"px").style("display","block").style("background","#fff").style("overflow","hidden");all_color_bar_expenditure=["#E9ECEE","#D4DADD","#f5e6eb","#e1afbf","#bf7a90"];var defs=svg.append("defs"),pattern_before=defs.append("pattern").attr("id","pattern_before").attr("width",8).attr("height",8).attr("patternUnits","userSpaceOnUse");pattern_before.append("rect").attr("x",0).attr("y",0).attr("fill",all_color_bar_expenditure[0]).attr("width",8).attr("height",8),pattern_before.append("line").attr("fill","none").attr("stroke","#474747").attr("stroke-width",.3).attr("x1",0).attr("y1",0).attr("x2",8).attr("y2",8);var pattern_default=defs.append("pattern").attr("id","pattern_default").attr("width",8).attr("height",8).attr("patternUnits","userSpaceOnUse");pattern_default.append("rect").attr("x",0).attr("y",0).attr("fill",all_color_bar_expenditure[1]).attr("width",8).attr("height",8),pattern_default.append("line").attr("fill","none").attr("stroke","#474747").attr("stroke-width",.3).attr("x1",0).attr("y1",0).attr("x2",8).attr("y2",8);var pattern_first_child=defs.append("pattern").attr("id","pattern_first_child").attr("width",8).attr("height",8).attr("patternUnits","userSpaceOnUse");pattern_first_child.append("rect").attr("x",0).attr("y",0).attr("fill",all_color_bar_expenditure[3]).attr("width",8).attr("height",8),pattern_first_child.append("line").attr("fill","none").attr("stroke","#474747").attr("stroke-width",.3).attr("x1",0).attr("y1",0).attr("x2",8).attr("y2",8);var g_second_child=defs.append("pattern").attr("id","g_second_child").attr("width",8).attr("height",8).attr("patternUnits","userSpaceOnUse");g_second_child.append("rect").attr("x",0).attr("y",0).attr("fill",all_color_bar_expenditure[4]).attr("width",8).attr("height",8),g_second_child.append("line").attr("fill","none").attr("stroke","#474747").attr("stroke-width",.3).attr("x1",0).attr("y1",0).attr("x2",8).attr("y2",8);var svg_expendeture=svg.append("g").attr("class","svg_expendeture").attr("transform","translate("+tranlate_svg_expendeture+",0)"),g_first_child=svg.append("g").attr("class","g_first_child");g_first_child.append("g").attr("class","grandparent");var g_second_child=svg.append("g").attr("class","g_second_child");g_second_child.append("g").attr("class","grandparent");var svg_r=div_revenue.append("svg").attr("width","100%").attr("height",height_g+margin.top+margin.bottom).style("margin-left",margin.left+"px").style("margin-right",margin.right+"px").style("display","block").style("background","#fff").style("overflow","hidden"),defs=svg_r.append("defs"),pattern_before_r=defs.append("pattern").attr("id","pattern_before_r").attr("width",8).attr("height",8).attr("patternUnits","userSpaceOnUse");pattern_before_r.append("rect").attr("x",0).attr("y",0).attr("fill","#52AED9").attr("width",8).attr("height",8),pattern_before_r.append("line").attr("fill","none").attr("stroke","#085475").attr("stroke-width",.3).attr("x1",0).attr("y1",0).attr("x2",8).attr("y2",8);var pattern_default_r=defs.append("pattern").attr("id","pattern_default_r").attr("width",8).attr("height",8).attr("patternUnits","userSpaceOnUse");pattern_default_r.append("rect").attr("x",0).attr("y",0).attr("fill","#1393D0").attr("width",8).attr("height",8),pattern_default_r.append("line").attr("fill","none").attr("stroke","#085475").attr("stroke-width",.3).attr("x1",0).attr("y1",0).attr("x2",8).attr("y2",8);var svg_revenue=svg_r.append("g").attr("class","svg_revenue").attr("transform","translate("+tranlate_svg_revenue+",0)");d3.selectAll(".list-option-radio div").each(function(){d3.select(this).append("svg").attr("viewBox","-7 -7 110 110")}),document.getElementById("rad-total-expenditure").checked=!0;var svg_from_rad=d3.select(d3.select("#rad-total-expenditure").node().parentNode).select("svg");draw_radio_button(svg_from_rad,animDefs),d3.selectAll(".rad-expenditure").on("change",function(){d3.selectAll(".content_control_expenditure .list-option-radio path").remove();var a=d3.select(this.parentNode).select("svg");if(draw_radio_button(a,animDefs),document.getElementById("rad-total-expenditure").checked){svg.selectAll(".small_scale").transition().duration(500).attr("opacity",1),svg_expendeture.selectAll(".depth").each(function(){form_show="millon";var a=this,b=d3.select(this).datum();f_ry.domain([0,max_value_every_year]),initialize(b),f_ry.domain([0,height_g]),layout(b),d3.select(a.parentNode).selectAll(".depth").style("shape-rendering",null),d3.select(this).datum(b),d3.select(this).selectAll("rect").transition().duration(750).call(rect).each("end",function(){d3.select(a.parentNode).selectAll(".depth").style("shape-rendering","crispEdges")})});var b=d3.scale.linear().domain([0,max_value_every_year]).range([height_g,0]),c=d3.svg.axis().scale(b).orient("left").tickFormat(function(a){return a/1e9+"b"});svg_expendeture.select(".expenditure_axis").call(c)}else{svg.selectAll(".small_scale").transition().duration(500).attr("opacity",0),svg_expendeture.selectAll(".depth").each(function(){form_show="percentaje";var a=this,b=d3.select(this).datum();f_ry.domain([0,b.value]),initialize(b),f_ry.domain([0,height_g]),layout(b),d3.select(a.parentNode).selectAll(".depth").style("shape-rendering",null),d3.select(this).datum(b),d3.select(this).selectAll("rect").transition().duration(750).call(rect).each("end",function(){d3.select(a.parentNode).selectAll(".depth").style("shape-rendering","crispEdges")})});var b=d3.scale.linear().domain([0,100]).range([height_g,0]),c=d3.svg.axis().scale(b).orient("left").tickFormat(function(a){return a+"%"});svg_expendeture.select(".expenditure_axis").call(c).selectAll(".tick text").attr("y",function(a){return 100===a?5:0})}compare_graphic_other_years(".content_control_expenditure",form_show)}),document.getElementById("rad-total-revenue").checked=!0;var svg_from_rad=d3.select(d3.select("#rad-total-revenue").node().parentNode).select("svg");draw_radio_button(svg_from_rad,animDefs),d3.selectAll(".rad-revenue").on("change",function(){d3.selectAll(".content_control_revenue .list-option-radio path").remove();var a=d3.select(this.parentNode).select("svg");if(draw_radio_button(a,animDefs),document.getElementById("rad-total-revenue").checked){svg_revenue.selectAll(".depth").each(function(){form_show_r="millon";var a=this,b=d3.select(this).datum();f_ry.domain([0,max_value_every_year_r]),initialize(b),f_ry.domain([0,height_g]),layout(b),d3.select(a.parentNode).selectAll(".depth").style("shape-rendering",null),d3.select(this).datum(b),d3.select(this).selectAll("rect").transition().duration(750).call(rect).each("end",function(){d3.select(a.parentNode).selectAll(".depth").style("shape-rendering","crispEdges")})});var b=d3.scale.linear().domain([0,max_value_every_year_r]).range([height_g,0]),c=d3.svg.axis().scale(b).orient("left").tickFormat(function(a){return a/1e9+"b"});svg_revenue.select(".revenue_axis").call(c)}else{svg_revenue.selectAll(".depth").each(function(){form_show_r="percentaje";var a=this,b=d3.select(this).datum();f_ry.domain([0,b.value]),initialize(b),f_ry.domain([0,height_g]),layout(b),d3.select(a.parentNode).selectAll(".depth").style("shape-rendering",null),d3.select(this).datum(b),d3.select(this).selectAll("rect").transition().duration(750).call(rect).each("end",function(){d3.select(a.parentNode).selectAll(".depth").style("shape-rendering","crispEdges")})});var b=d3.scale.linear().domain([0,100]).range([height_g,0]),c=d3.svg.axis().scale(b).orient("left").tickFormat(function(a){return a+"%"});svg_revenue.select(".revenue_axis").call(c).selectAll(".tick text").attr("y",function(a){return 100===a?5:0})}compare_graphic_other_years(".content_control_revenue",form_show_r)});var obj_json={},obj_array_revenue={};d3.csv(url_sub_expenditure_csv,function(a,b){var c=build_enlace(b,year_default);d3.csv(url_expenditure_csv,function(a,b){var d=build_array_key_select(b,array_year),e={},f="";d.forEach(function(a){a.year<=year_default-1&&(f+="<option value='"+a.year+"' "+(a.year===year_default-1?"selected":"")+">"+a.year+"</option>"),obj_json[a.year]={},obj_json[a.year].name=a.year,obj_json[a.year].lastname="Expenditure",obj_json[a.year].children=build_json(array_branches,a,b,year_default,c,e)}),$(".control-expediture .option_year_expenditure").html(f),d3.select(".control-expediture .option_year_expenditure").on("change",function(){var a=this.selectedIndex,b=array_year[a];d3.select(".g_first_child .depth").empty()?d3.select(".control-expediture .text_graphic_complete").datum([obj_json[year_default],obj_json[b]]):d3.select(".g_second_child .depth").empty()?d3.selectAll(".expenditure"+b+" .children").each(function(a){a.name.trim()===d3.select(".g_first_child .depth").datum().name.trim()&&d3.select(".control-expediture .text_graphic_complete").datum([d3.select(".g_first_child .depth").datum(),a])}):d3.selectAll(".expenditure"+b+" .children rect.child").each(function(a){a.name.trim()===d3.select(".g_second_child .depth").datum().name.trim()&&d3.select(".control-expediture .text_graphic_complete").datum([d3.select(".g_second_child .depth").datum(),a])}),compare_graphic_other_years(".content_control_expenditure",form_show)}),d3.csv(url_revenue_csv,function(a,b){var c=build_array_key_select(b,array_year);obj_array_revenue=build_json_revenue(b,c);initialize_all_year(c,obj_json,obj_array_revenue);$(".control-revenue .option_year_revenue").html(f),d3.select(".control-revenue .option_year_revenue").on("change",function(){var a=this.selectedIndex,b=array_year[a];d3.select(".svg_revenue .g_first_child .depth").empty()&&d3.select(".control-revenue .text_graphic_complete").datum([obj_array_revenue[year_default],obj_array_revenue[b]]),compare_graphic_other_years(".content_control_revenue",form_show_r)}),d3.select(".content_control_expenditure .text_graphic_complete").datum([obj_json[year_default],obj_json[year_default-1]]),d3.select(".content_control_revenue .text_graphic_complete").datum([obj_array_revenue[year_default],obj_array_revenue[year_default-1]]),compare_graphic_other_years(".content_control_expenditure",form_show),compare_graphic_other_years(".content_control_revenue",form_show_r),display_block_budget(obj_json,svg_expendeture,c),display_block_budget(obj_array_revenue,svg_revenue,c),create_breadcumb(obj_json[year_default],".st-breadcumb-expenditure"),create_breadcumb(obj_array_revenue[year_default],".st-breadcumb-revenue"),d3.select(".st-breadcumb-expenditure").style("margin-left",tranlate_svg_expendeture-30+"px"),d3.select(".st-breadcumb-revenue").style("margin-left",tranlate_svg_revenue-30+"px");var d=0;$(".st-graphic-expenditure").waypoint(function(a){if("down"===a&&0===d){d=1;var b=d3.select(this).select("svg").append("g").attr("class","g_hand_mov").attr("transform","translate("+(tranlate_svg_expendeture+width_g-30)+",0)");b.append("polygon").attr("points","17.3,25.5 17.2,15.2 16,14.1 14.8,14.1 13.6,15.2 13.6,32.9 12.2,32.9 8.5,29.3 6.3,29.4 5.6,30 5.7,32 12,38.3 16.3,42.4 16.4,45.8 27.5,44.9 27.5,41.4 29.6,39.3 29.8,26.6 28.7,25.5").attr("opacity",.85);var c=b.append("circle").attr("opacity",.85).attr("fill","none").attr("stroke","#000000").attr("stroke-width",2).attr("stroke-miterlimit",10).attr("cx",15).attr("cy",14.5).attr("r",7.4);b.transition().duration(3e3).attr("transform","translate("+(tranlate_svg_expendeture+width_g-30)+","+(height_g-36)+")").each("end",function(){b.transition().duration(3e3).attr("transform","translate("+(tranlate_svg_expendeture+width_g-30)+",0)").each("end",function(){b.transition().attr("opacity",1).duration(500).attr("opacity",0).attr("display","none")})}),c.call(circle_flash1)}},{offset:"50%"});var e=0;$(".st-graphic-revenue").waypoint(function(a){if("down"===a&&0===e){e=1;var b=d3.select(this).select("svg").append("g").attr("class","g_hand_mov").attr("transform","translate("+(tranlate_svg_revenue+width_g-30)+",0)");b.append("polygon").attr("points","17.3,25.5 17.2,15.2 16,14.1 14.8,14.1 13.6,15.2 13.6,32.9 12.2,32.9 8.5,29.3 6.3,29.4 5.6,30 5.7,32 12,38.3 16.3,42.4 16.4,45.8 27.5,44.9 27.5,41.4 29.6,39.3 29.8,26.6 28.7,25.5").attr("opacity",.85);var c=b.append("circle").attr("opacity",.85).attr("fill","none").attr("stroke","#000000").attr("stroke-width",2).attr("stroke-miterlimit",10).attr("cx",15).attr("cy",14.5).attr("r",7.4);b.transition().duration(3e3).attr("transform","translate("+(tranlate_svg_revenue+width_g-30)+","+(height_g-36)+")").each("end",function(){b.transition().duration(3e3).attr("transform","translate("+(tranlate_svg_revenue+width_g-30)+",0)").each("end",function(){b.attr("opacity",1).transition().duration(500).attr("opacity",0).attr("display","none")})}),c.call(circle_flash1)}},{offset:"50%"}),create_autocomplete($("#input_search_e"),obj_json[year_default]),create_autocomplete_r($("#input_search_r"),obj_array_revenue[year_default]),$(".content_control_expenditure .term_max_increase, .content_control_expenditure .term_min_increase").on("click","span",function(){var a=$(this).text();d3.selectAll(".st-graphic-expenditure .g_first_child .depth").empty()?d3.selectAll(".expenditure"+year_default+" rect.parent").each(function(b){b.name.trim()===a&&(mouseout_rect(b),mark_rect_over(b),d3.select(".tooltip_expenditure").style("display","none"))}):d3.selectAll(".st-graphic-expenditure .g_first_child rect.parent").each(function(b){b.name.trim()===a&&(mouseout_rect(b),mark_rect_over(b),d3.select(".tooltip_expenditure").style("display","none"))})}),$(".content_control_revenue .term_max_increase, .content_control_revenue .term_min_increase").on("click","span",function(){var a=$(this).text();d3.selectAll(".revenue"+year_default+" rect.parent").each(function(b){b.name.trim()===a&&(mouseout_rect(b),mark_rect_over(b),d3.select(".tooltip_revenue").style("display","none"))})})}),window.onload=function(){},window.onresize=function(){}})});
---
title: 2.37 读书<Java并发编程实战>
permalink: /android/java/concurrency/
last_modified_at: 2019-09-04T09:45:06-05:00
tags:
  - Java Concurrency
categories:
  - Java Concurrency
---

### 2.37.1 Java内存区域与内存溢出异常

- 对象的共享
  - Volatile变量(典型用法: 检查某个状态标记以判断是否退出循环)
  - 发布与逸出, 发布即使对象能够在当前作用域之外的代码中使用。逸出即当某个不应该发布的对象被发布
  - 线程封闭(Thread Confinement), 仅在单线程内访问数据, 不需要同步
    - Ad-hoc线程封闭, 维护线程封闭性的职责完全由程序实现来承担(封闭性弱, 尽量不使用)
    - 栈封闭
    - ThreadLocal
  - 安全发布
    - 不可变对象与初始化安全性, 状态不可修改, 所有域都是final类型, 以及正确构造
    - 安全发布的常用模式
      - 线程安全库提供以下安全发布保证
        - 通过将一个键或者值放入`HashTable`、`synchronizedMap`或者`ConcurrentMap`中, 可以安全地将它发布给任何从这些容器中访问它的线程
        - 通过将某个元素放入`Vector`、`CopyOnWriteArrayList`、`CopyOnWriteArraySet`、`synchronizedList`或者`synchronizedSet`中, 可以将该元素安全地发布到任何从这些容器中访问该元素的线程
        - 通过将某个元素放入`BlockingQueue`或者`ConcurrentLinkedQueue`中, 可以将该元素安全地发布到任何从这些队列中访问该元素的线程
      - 事实不可变对象, 如果对象从技术上来看是可变的, 但其状态在发布后不会再改变
      - 可变对象, 必须通过安全方式发布, 必须是线程安全或者由某个锁保护起来
  - 共享对象的使用策略
    - 线程封闭
    - 只读共享
    - 线程安全共享
    - 保护对象

-

### 参考
- [Java并发编程实战](https://book.douban.com/subject/10484692/)

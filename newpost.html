---
layout: default
permalink: /newpost/
javascripts: [/js/d3.min.js, /js/c3.min.js]
csses: [/css/c3.css]
---

<div id="balanceChart" style="width: 90%; height: 300px;"></div>
<script type="text/javascript">
    
    function createItem(balance, rate, payment, minpayment) {
        var item = {balance:balance, 
                    rate:rate, 
                    payment:payment, 
                    minpayment: minpayment, 
                    minpaymenttype: 'dollar',
                    update: function() {
                        balance = balance * (1 + rate / 12) - payment;
                        
                        if(balance < minpayment) {
                            minpayment = balance;   
                        }
        
                        if(balance <= 0) {
                            balance = 0;
                            minpayment = 0;
                        }
                    }
        };
    }
    
    function getBalances(items) {
        var emptyItem = {balance:0,minpayment:0};
        
        var balances = [[0, 
                         items.reduce(function (p, c) { return p.balance + c.balance; }, emptyItem),
                         items.reduce(function (p, c) { return p.minpayment + c.minpayment;}, emptyItem)]];
        
        var month = 1;
    
        while (items.reduce(function (p, c) { return p.balance + c.balance; }, emptyItem) > 0) {
            items.foreach(function(item){item.update();});
    
            balances.push([month, 
                           items.reduce(function (p, c) { return p.balance + c.balance; }, emptyItem),
                           items.reduce(function (p, c) { return p.minpayment + c.minpayment;}, emptyItem)]);

            month++;
        }
        
        return balances;
    }
        
    var house = {balance:100000, rate:0.06, payment:1000, minpayment: 1000, minpaymenttype: 'dollar' };
    var car = {balance:20000, rate:0.1, payment:250, minpayment: 250, minpaymenttype: 'dollar' };
    var everything = [house, car];
    
    var balances = [['month', 'balance', 'minpayment']];
    balances = balances.concat(getBalances(everything));

    var chart = c3.generate({
        bindto: '#balanceChart',
        data: {
            x: 'month',
            rows: balances,
            type: 'spline'
        },
        axis: {
            x: {
                label: {
                    text: 'month',
                    position: 'outer-center'
                }
            },
            y: {
                label: {
                    text: 'dollars',
                    position: 'outer-middle'
                }
            }
        }
    });
</script>

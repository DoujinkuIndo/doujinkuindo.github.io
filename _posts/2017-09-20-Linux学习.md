## Linux 学习

# Ubuntu 14.04 配置iptables防火墙

Ubuntu默认安装是没有开启任何防火墙的，为了服务器的安全，建议大家安装启用防火墙设置，这里推荐使用iptables防火墙.如果mysql启本地使用,可以不用打开3306端口.

参考链接：http://www.cnblogs.com/general0878/p/5757377.html

1、查看系统是否安装防火墙

```js
whereis iptables
```

出现如上提示表示已经安装iptables，如果没有安装，可以通过以下命令安装

```js
sudo apt-get install iptables
```

2、查看防火墙的配置信息

```js
iptables -L
```

3、修改规则文件把3306的DROP改为ACCEPT
```js
vi /etc/iptables.rules 
```

4、使防火墙生效
```js
iptables-restore < /etc/iptables/rules.v4
```
5、创建文件，添加以下内容，使防火墙开机启动
```js
vi /etc/network/if-pre-up.d/iptables
#!/bin/bash
iptables-restore < /etc/iptables/rules.v4
```
6、添加执行权限
```js
chmod +x /etc/network/if-pre-up.d/iptables
```
7、查看规则是否生效
```js
iptables -L -n
```

# chown更改文件所属用户
一开始使用root登录上传，后来用lnmp add ftp，新建了个www用户后，上传文件提示权限问题，执行以下命令就可以了。
```js
chown www:www -R tyc
```

# cp拷贝文件夹
CP命令 
格式: CP [选项] 源文件或目录 目的文件或目录 
选项说明:-b 同名,备份原来的文件 
-f 强制覆盖同名文件 
-r 按递归方式保留原目录结构复制文件 
```js
cp -r /tmp/a /root/a 
```
记得有空格。

# rm删除文件夹命令

linux删除目录很简单，很多人还是习惯用rmdir，不过一旦目录非空，就陷入深深的苦恼之中，现在使用rm -rf命令即可。
直接rm就可以了，不过要加两个参数-rf 即：rm -rf 目录名字

删除目录、文件 rm(remove)

功能说明：删除文件或目录。
语法：rm [-dfirv][--help][--version][文件或目录...]
补充说明：执行rm指令可删除文件或目录，如欲删除目录必须加上参数”-r”，否则预设仅会删除文件。 
参数：
* -d或–directory 　直接把欲删除的目录的硬连接数据删成0，删除该目录。 
* -f或–force 　强制删除文件或目录。 
* -i或–interactive 　删除既有文件或目录之前先询问用户。 
* -r或-R或–recursive 　递归处理，将指定目录下的所有文件及子目录一并处理。 
* -v或–verbose 　显示指令执行过程。 

* 1 删除文件夹
de>rm -rf  fileNamede>
 

删除文件夹实例：
rm -rf /var/log/httpd/access

将会删除/var/log/httpd/access目录以及其下所有文件、文件夹
需要提醒的是：使用这个rm -rf的时候一定要格外小心，linux没有回收站的

* 2 删除文件
de>rm -f  fileNamede>
使用 rm -rf 的时候一定要格外小心，linux没有回收站的

# 查找文件
```js
find / -name php.ini
```

# screen 命令学习
## 清除dead 会话
如果由于某种原因其中一个会话死掉了（例如人为杀掉该会话），这时screen -list会显示该会话为dead状态。使用screen -wipe命令清除该会话：

## 关闭或杀死窗口
正常情况下，当你退出一个窗口中最后一个程序（通常是bash）后，这个窗口就关闭了。另一个关闭窗口的方法是使用C-a k，这个快捷键杀死当前的窗口，同时也将杀死这个窗口中正在运行的进程。
如果一个Screen会话中最后一个窗口被关闭了，那么整个Screen会话也就退出了，screen进程会被终止。
除了依次退出/杀死当前Screen会话中所有窗口这种方法之外，还可以使用快捷键C-a :，然后输入quit命令退出Screen会话。需要注意的是，这样退出会杀死所有窗口并退出其中运行的所有程序。其实C-a :这个快捷键允许用户直接输入的命令有很多，包括分屏可以输入split等，这也是实现Screen功能的一个途径，不过个人认为还是快捷键比较方便些。

# 添加用户
useradd -d /home/wwwroot -M -r www

# PS命令使用
ps -AF | grep php

# linux压缩和解压缩命令大全
## tar命令
* 解包：tar zxvf FileName.tar
* 打包：tar czvf FileName.tar DirName

## gz命令
* 解压1：gunzip FileName.gz
* 解压2：gzip -d FileName.gz
* 压缩：gzip FileName
* .tar.gz 和 .tgz
* 解压：tar zxvf FileName.tar.gz
* 压缩：tar zcvf FileName.tar.gz DirName
* 压缩多个文件：tar zcvf FileName.tar.gz DirName1 DirName2 DirName3 ...

# 符号链接
也就是说, xxx 这个是指向 xxx-1.9.4 的, 即访问xxx, 实际上就是访问 xxx-1.9.4
可以用命令: ln
ln -s 要指向的目录文件 目标名称

sudo ln -s 源文件 目标文件 
举例：
当前目录是/local，而我经常要访问/usr/local/linux/work
那么我就可以使用在local下建立一个文件linkwork，
然后sudo ln -s /usr/local/linux/work  /local/linkwork
即建立两者之间的链接。

删除链接
rm -rf   symbolic_name   注意不是rm -rf   symbolic_name/ 
那么上面我就是rm -rf   /local/linkwork

php -version
-bash: php: command not found
因为在环境变量 PATH 里的路径里找 php 的时候, 找不到它
可以做符号链接:
ln -s /usr/local/php/bin/php /usr/local/bin/php

还有一些扩展, 不是php自带的, 需要手工安装. 例如安装 memcache:
pecl install memcache
pecl install igbinary
pecl install redis
也是 "下载 -> 解压 -> 配置 -> 编译 -> 安装" 这个过程.
ln -s /usr/local/php/bin/pecl /usr/local/bin/pecl

# 编译PHP
需要安装的扩展
./configure --prefix=/usr/local/php \
--with-config-file-scan-dir=/etc/php.d \
--with-config-file-path=/etc \
--enable-pdo \
--with-mysql=/usr/local/mysql \
--with-pdo-mysql=/usr/local/mysql \
--with-mysqli=/usr/local/mysql/bin/mysql_config \
--enable-mbstring \
--with-freetype-dir \
--with-jpeg-dir \
--with-png-dir \
--with-zlib \
--with-libxml-dir=/usr \
--with-openssl \
--enable-xml \
--enable-simplexml \
--enable-sockets \
--enable-fpm \
--with-mcrypt \
--with-bz2 \
--enable-soap \
--enable-bcmath \
--with-curl \
--with-gd \
--enable-mysqlnd \
--enable-pcntl \
--enable-sysvmsg \
--enable-sysvsem \
--enable-sysvshm \
--with-xsl \
--enable-zip 

如有不确定的就输入命令./configure --help 然后查找一下。disabled的就是自带的。
注意：pdo-mysql 配置的是内置的, 所以 pdo 也必须是内置的.
configure: error: 
You've configured extension pdo_mysql to build statically, but it
depends on extension pdo, which you've configured to build shared.
You either need to build pdo_mysql shared or build pdo statically for the
build to be successful.

/usr/local/php/lib/php/extensions/no-debug-non-zts-20131226/
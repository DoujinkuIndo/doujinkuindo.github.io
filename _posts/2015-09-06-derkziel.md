---
title: Derkziel Software
updated: 2015-09-06 15:56
---
Intro
====
What do we know about Derkziel? ...not much yet, but the little we know looks like a joke. Derkziel Software was a totally unknown adversary to us, actually the first time we noticed it was sifting through What do we know about Derkziel? ...not much yet, but the little we know looks like a joke. Derkziel Software was a totally unknown adversary to us, actually the first time we noticed it was sifting through[ \[CyberCrime Tracker\]](http://cybercrime-tracker.net/index.php?search=Derkziel).

So why did we decide to analyze Derkziel?, hmm well to be totally honest, we had nothing better to do at 03:00 am.

![enter image description here](http://cdn.meme.am/instances/63552921.jpg)

We know, it doesn’t sound like a typical sexy malware tale…​ but anyway!

Sample Analysis
For static analysis we used [Radare2](http://radare.org/r/). Now, we don’t want to make a whole post about radare2, it’s just that we use this framework because we are phun! people. There is plenty of [documentation](http://radare.org/r/docs.html) in their website as well as slide decks for [talks and workshops.](http://radare.org/r/talks.html)

To get into matters, first we run rahash2. This is part of Radare2, with this tool we will hash one of our files.

**$ rahash2 -a md5 derk/user0000036-601704015.tmp**

    derk/user0000036-601704015.tmp: 0x00000000-0x0007c1ff md5: 7525ef63c8e9346a3e897c8d91231a73*

For the next step we use **rabin2**. This tool allows you to get all sort of useful information about *ELF/PE/MZ* and *CLASS* files in a simple way, we pipe to grep to filter the class. Easy. *PE*. We love PE files!

**$ rabin2 -I derk/user0000036-601704015.tmp | grep class**

    class    PE32

Okay, so we want more info about the binary: again rabin2.

**$ rabin2 -k '*' derk/user0000036-601704015.tmp**

    archs=0:0:x86:32
    pe.canary=false
    pe.highva=false
    pe.aslr=false
    pe.forceintegrity=false
    pe.nx=false
    pe.isolation=true
    pe.seh=true
    pe.bind=true
    pe.appcontainer=false
    pe.wdmdriver=false
    pe.guardcf=false
    pe.terminalserveraware=false
    pe.bits=0x20*

For extracting sections we use -S. Here we go!

**$ rabin2 -S derk/user0000036-601704015.tmp**

    Sections
    idx=00 vaddr=0x00401000 paddr=0x00000400 sz=403968 vsz=403628 perm=m-r-x name=.text
    idx=01 vaddr=0x00464000 paddr=0x00062e00 sz=512 vsz=280 perm=m-r-x name=.itext
    idx=02 vaddr=0x00465000 paddr=0x00063000 sz=38400 vsz=38004 perm=m-rw- name=.data
    idx=03 vaddr=0x0046f000 paddr=0x0006c600 sz=0 vsz=12532 perm=m-rw- name=.bss
    idx=04 vaddr=0x00473000 paddr=0x0006c600 sz=5632 vsz=5382 perm=m-rw- name=.idata
    idx=05 vaddr=0x00475000 paddr=0x0006dc00 sz=0 vsz=8 perm=m-rw- name=.tls
    idx=06 vaddr=0x00476000 paddr=0x0006dc00 sz=512 vsz=24 perm=m-r-- name=.rdata
    idx=07 vaddr=0x00477000 paddr=0x0006de00 sz=13312 vsz=13216 perm=m-r-- name=.reloc
    idx=08 vaddr=0x0047b000 paddr=0x00071200 sz=45056 vsz=45044 perm=m-r-- name=.rsrc




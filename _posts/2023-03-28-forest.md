---
layout: post
title: 2023-03-forest.md
---

# Forest

![Box Description](/images/forest/Forest.png)
This is an Easy Windows retired machine that is a good introduction to windows enumeration. It is distinct in that it doesn't contain a web server like most machines in HackTheBox. I start off with an nmap scan to see which ports are open and what services are running. My prefered method for CTFs is

**nmap -A -T4 -p- ipaddress**

Nmap Scan
![nmap](/images/forest/nmap.png)
As you can see there are a lot of ports open which is typical of windows machines. After seeing the services open I turn my focus to SMB.

SMB Enumeration
![smb](/images/forest/smb.png)
I run smbmap to list all shares but I am not able to view anything. It's always a good idea to use multiple tools to enumerate services whenever you can in case one doesn't work with that particular service. There is no anonymous access so I move on. If I find credentials later I can come back to try to list the shares. I next focus on LDAP which is the second lowest hanging fruit. As we can see the Lightweight Directory Access Protocol (LDAP) is listening on a number of ports. That is an indication that this system is a domain controller.

LDAP Enumeration
![ldap with nmap](/images/forest/ldap2.png)
I like to run this nmap script to initially enumerate LDAP before I dive in deeper. 
![ldap](/images/forest/ldap.png)
After enumerating with ldapsearch I get a lot of information so I save it to a file to grep out useful information. A searching shorcut for useful things to look at could be

* cat filename | grep -I user
* cat filename | grep -I memberof
* cat filename | grep -I description
* cat filename | grep -I sAMAccountName
* cat filename | grep -I userPrincipalName

As you are reviewing this file look for interesting things to grep out. 

RPClient
![RPC Enumeration](/images/forest/rpclient.png) "RPC Enumeration")


![RPC User Enumeration](/images/forest/rpc.png) "RPC User Enumeration")

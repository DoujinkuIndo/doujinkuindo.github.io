---
layout: post
title: Отладка в PHPStorm с XDebug из BitrixVM через HTTPS
---

И так есть тестовый проект за **https** запущенный в **BitrixVM**.
Например **https://test.example.org**
Настройка **PHPStorm** чтобы можно отладить проект запущенный на сервере в сети в **https** протоколе.
Для начало нужно настроить **XDebug** на сервере.
Например у **BitrixVM** оно же под **CentOS**
в дериктории **/etc/php.d** имеется как минимум два файла для **XDebug**:

{% highlight text %}
15-xdebug.ini 
15-xdebug.ini.disabled
{% endhighlight %}

для простоты добавьте эти настройки в **15-xdebug.ini**

{% highlight ini %}
zend_extension=xdebug.so
xdebug.default_enable = 1
xdebug.overload_var_dump = 1
xdebug.show_exception_trace = 1
xdebug.idekey = "PHPSTORM"
xdebug.remote_autostart = 1
xdebug.remote_enable = 1
xdebug.remote_handler = dbgp
xdebug.remote_connect_back = 1
xdebug.remote_mode = req
xdebug.remote_port = 9000
{% endhighlight %}

Тут определили параметры для **XDebug** чтобы он слушал порт **9000** на обратный адрес по запросу и ключ для идентификации IDE. Этого хватает для отладки. Отладчик всегда запущеный и слушает запросы.
Нужно перезагрузить хотя бы Apache сервер. Чтобы наша новая конфигурация втупило в силу.

{% highlight bash %}
apachectl restart
{% endhighlight %}

И так с XDebug закончилось настройки.

Дальше PHPStorm.
Нужно подсоедениться по SSH к PHP интерпретатору в BitrixVM на сервере.

![Шаг 0](/images/step0.png)

Должно быть так, выбран тот интерпретатор на удаленке сервера.

![Шаг 1](/images/step1.png)

Нужно создать адрес к серверу. **Заметьте!!!** Что порт **443** т.к. у нас тестовый ландшафт находиться за **HTTPS**.
И еще, нужно сопоставить путь на локальном рабочем компе с директорией на сервере где наш проект.

![Шаг 2](/images/step2.png)

Проставьте чекбоксы как на скриншоте, для того чтобы исключить дебагеру не наши соединения (левые), чтобы не уведомлять о пропущенных соединениях. И убрать флажки от срабатывания в первых строчках файла. От левых проектов или скриптов под **cron**

![Шаг 3](/images/step3.png)

Тут пропишем хост к серверу, ключ наш PHPSTORM и порт.

![Шаг 4](/images/step4.png)

Вот все. Удачной отладки, коллеги! Проект за бугром на сервере, отладка на коленке у себя.

![Шаг 5](/images/step5.png)

Не забывайте, включить **трубку** в PHPSTORM перед запуском страницы для отладки.
Плагин для Chrome не нужен, наш XDebug всегда включен и не ожидает специальной GET параметра в запросе из под страницы.

**ВНИМАНИЕ!!!** Если у Вас на локальной машине крутиться **BitrixVM** под **VMware** или **VirtualBox**
то не забудьте выбрать в настройках тип соединения с сетью Bridge (Мост) чтобы было доступ к виртуалке. И порт конечно 80 вместо 443, адрес будет например 192.168.1.48 в котором находиться наша BitrixVM

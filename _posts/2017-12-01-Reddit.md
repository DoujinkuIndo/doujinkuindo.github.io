---
layout: post
title: Reddit
---

<img src="/images/Reddit_images/reddit.png" width="200">


## Summary

The goal of this project is to predict the subreddit a post is under based on the title and text of the post analyzed using Natural Language Processing. The catch here is that this data set only includes technical subreddits, so the words used between subreddits are similar. 

## Preprocessing

This Reddit dataset was taken from just one month, and there are limited observations in some categories. So to increase the observation in each category some categories have been combined and expanded. Subreddits with more than 1000 observations were kept; Techsupport, Programming, and Python.

## Up Votes 

One of the few features that had enough variability to be kept in the data set is the up votes each post receives. The distribution for each subreddit is shown below. A cap has been up on at four up votes because there are a few outliers that severely skew the data. Posts with four vote or higher are normalized to having only 4. 

The Techsupport subreddit dictates the distribution of all the subreddits shown in black.

![an image alt text](/images/Reddit_images/All_Hist.png "All Subreddits Up Votes Histogram")

When divided up each subreddit has a distinct shape. 

### Techsupport

![an image alt text](/images/Reddit_images/Tech_Hist.png "Techsupport Up Votes Histogram")

### Programming

![an image alt text](/images/Reddit_images/Pro_Hist.png "Programming Up Votes Histogram")

### Python

![an image alt text](/images/Reddit_images/Py_Hist.png "Python Up Votes Histogram")


## Natural Language Processing

The preprocessing is taken care of by a single function shown below. The TFIDFVectorizer is used because it increases proportionally to count, but is offset by the frequency of the word in the corpus. This is because all the Reddit posts are in some technology subreddit, so it is probable that there is a commonality in the language used.

The Vectorized matrix is then concated to the binary variables and the Up Votes. This function then uses PCA (Principal Component Analysis) to combine and limit the features the Vectorizer outputs into 500 features. 

There is no standardization because the columns more than 99% of the columns going into PCA are on the same scale already, and the outlier columns (Up Votes), are on a very similar scale. 

![an image alt text](/images/Reddit_images/NLP_function.png "NLP Function")

## Modeling

Modeling for this dataset was broken into 3 categories, each predicting if the post was in that subreddit or not. Random Forests, KNearestNeighbors, and Logistic Regression were all used to predict the subreddit, Logistic Regression preformed the best for each prediction, optimized with the hyperparameter C=8.

### Techsupport

The Confusion Matrix for predicting if a post has a subreddit of Techsupport or not. 

![an image alt text](/images/Reddit_images/Tech_Matrix.png "Techsupport Confusion Matrix")

The cross validated accuracy score on the test data of 96.8% is weel above the baseline of 67.9%. Due to the nature of the data there is no preference to optimizing the precision versus optimizing the recall. 

### Programming

The cross validated scores on the test data for predicting Programming subreddits is lower than the Techsupprt model, additionally the baseline is higher. The model preforms worse than Techsupport most likely because there are fewer observations that fall into the subreddit.

![an image alt text](/images/Reddit_images/Pro_Matrix.png "Programming Confusion Matrix")

### Python
 
 The Python model has an even higher baseline than the two previous and performs the worst of the three. This follows the pattern that the model fails more frequently the fewer observations it has of the particular subreddit.

![an image alt text](/images/Reddit_images/Py_Matrix.png "Python Confusion Matrix")


### Neural Network

The Nerual Network imporved predicting 

As a further step a neural network was created to predict all three top subreddits together. This baseline prediction for this the same as the baseline for predicting only Techsupport. The cross validated accuracy score of the model is 91.5%, well above the baseline.

![an image alt text](/images/Reddit_images/All_net_Matrix.png "Neural Network Confusion Matrix")

This model is the most useful for the future, for predicting new data in the future because it predicts all three subreddits together. 

## Conclusion

Reddit posts between technical subreddits have distinct language. With enough observations you may beable to accuractly predict the subreddit in many more categories. 
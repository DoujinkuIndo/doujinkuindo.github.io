/*
Last Updated: 2016年6月10日 11:07:03

COTA
http://cota.jp
*/
!function(c,b){var a=c.jQuery;if("function"==typeof define&&define.amd){a?define([],b.bind(null,a)):define(["jquery"],b)}else{if("object"==typeof exports){module.exports=b(a?a:require("jquery"))}else{if(!a){throw"Missing required jQuery dependency"}c.setIframeHeight=b(a)}}}(this,function(l){function b(c){var a=null;return l("iframe").each(function(r,e){var i=l(e),o=i.attr("data-iframeAutoHeight-currentSrc")||e.src;return o&&(o=j(o),o===c)?(a=e,!1):void 0}),a}function s(c){var a=null;return l("iframe").each(function(e,f){var d=l(f);return d.data("setIframeHeight_id")===c?(a=f,!1):void 0}),a}function j(a){return 0===a.indexOf("/")&&(a=h(document.location.href)+a),a}function h(c){var a=c.match(/https?:\/\/.[^/]+/)||[];return a[0]}function q(a){return a.replace(/^https?:\/\//,"//")}function k(c,t){var v;if(v=s(t.iframeId),v||(v=b(t.iframeSrc)),!v&&t.iframeReferrer&&(v=b(t.iframeReferrer)),v){var a=l(v),i=l(window);a.data("setIframeHeight_id",t.iframeId),a.height(t.height);var r=q(a.attr("data-iframeAutoHeight-currentSrc")||v.src)!==q(t.iframeSrc);a.attr("data-iframeAutoHeight-currentSrc",t.iframeSrc);var x=p[t.iframeId],w=t.height;if(void 0===x?i.trigger("setIframeHeight:determined",t):x>w?i.trigger("setIframeHeight:shrinked",t):w>x&&l(window).trigger("setIframeHeight:enlarged",t),p[t.iframeId]=w,window.history.replaceState&&a.attr("data-iframeAutoHeight-deepLinkPattern")&&r){var e=j(a.attr("data-iframeAutoHeight-deepLinkPattern").replace(/%deepLinkIframeSrc%/,encodeURIComponent(t.iframeSrc)));q(document.location.href)!==q(e)&&(window.history.replaceState({},"",e),l(window).trigger("setIframeHeight:deepLink:changed",{childUrl:t.iframeSrc,parentUrl:e})),v.contentWindow&&v.contentWindow.postMessage&&v.contentWindow.postMessage('setIframeHeight:deepLink:changed::{ "parentUrl": "'+e+'", "childUrl": "'+t.iframeSrc+'"}',"*")}}}function m(d){var c=d.originalEvent.data;if("string"==typeof c&&c.indexOf("::")){var c=c.split("::");if(2===c.length&&"setIframeHeight"===c[0]){var a=l.parseJSON(c[1]);g.setHeight(a)}}}l(window).bind("setIframeHeight",k).bind("message",m);var g={setHeight:function(a){a.height=parseInt(a.height,10),l(window).trigger("setIframeHeight",[a])}},p={};return g});